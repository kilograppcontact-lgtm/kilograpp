{% extends 'base.html' %}
{% block content %}
<div class="max-w-7xl mx-auto px-4 py-6" x-data="{showBody:true}">
  <div class="flex items-center justify-between mb-4">
    <h1 class="text-2xl font-bold">üß© –ü—Ä–æ–º–ø—Ç—ã</h1>
    <button class="px-3 py-1.5 rounded-lg bg-gray-100 hover:bg-gray-200 text-sm" @click="showBody=!showBody">
  <span x-text="showBody ? '–°–∫—Ä—ã—Ç—å –Ω–æ–≤—ã–π' : '–ü–æ–∫–∞–∑–∞—Ç—å –Ω–æ–≤—ã–π'"></span>
</button>

  </div>

  <div class="grid lg:grid-cols-2 gap-6">
    <!-- –°–æ–∑–¥–∞–Ω–∏–µ -->
    <div class="bg-white rounded-xl shadow p-4" x-show="showBody">
      <h2 class="font-semibold mb-2">–°–æ–∑–¥–∞—Ç—å/—Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –≤–µ—Ä—Å–∏—é</h2>
      <form method="post" class="space-y-3">
        <div class="grid md:grid-cols-2 gap-3">
          <input class="w-full border rounded-lg px-3 py-2" name="name" placeholder="name (–Ω–∞–ø—Ä–∏–º–µ—Ä: meal_photo)" required>
          <input class="w-full border rounded-lg px-3 py-2" type="number" name="version" placeholder="version" required>
        </div>
        <textarea class="w-full border rounded-lg px-3 py-3 min-h-[220px]" name="body" placeholder="–¢–µ–∫—Å—Ç —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ –ø—Ä–æ–º–ø—Ç–∞" required></textarea>
        <div class="flex items-center gap-3">
          <button class="px-3 py-2 rounded-lg bg-emerald-600 text-white hover:bg-emerald-700">–°–æ—Ö—Ä–∞–Ω–∏—Ç—å</button>
          <span class="text-xs text-gray-500">–°–Ω–∞—á–∞–ª–∞ —Å–æ—Ö—Ä–∞–Ω–∏, –ø–æ—Ç–æ–º –∞–∫—Ç–∏–≤–∏—Ä—É–π –Ω—É–∂–Ω—É—é –≤–µ—Ä—Å–∏—é –≤ —Å–ø–∏—Å–∫–µ —Å–ø—Ä–∞–≤–∞</span>
        </div>
      </form>
    </div>

    <!-- –°–ø–∏—Å–æ–∫ -->
    <div class="bg-white rounded-xl shadow p-0 overflow-hidden">
      <div class="px-4 py-3 border-b">
        <div class="text-sm text-gray-600">–°–æ—Ö—Ä–∞–Ω—ë–Ω–Ω—ã–µ —à–∞–±–ª–æ–Ω—ã</div>
      </div>
      <div class="divide-y max-h-[640px] overflow-auto">
        {% for p in prompts %}
          <div class="p-4 flex items-start justify-between gap-4">
            <div class="min-w-0">
              <div class="flex items-center gap-2">
                <div class="font-semibold truncate">{{ p.name }}</div>
                <div class="text-xs px-2 py-0.5 rounded-full"
                     style="background: {{ p.is_active and '#DCFCE7' or '#F1F5F9' }}; color: {{ p.is_active and '#166534' or '#334155' }};">
                  v{{ p.version }}{{ p.is_active and ' ‚Ä¢ –∞–∫—Ç–∏–≤–µ–Ω' or '' }}
                </div>
              </div>
              <details class="mt-2">
                <summary class="cursor-pointer text-sm text-gray-600">–ü–æ–∫–∞–∑–∞—Ç—å —Ç–µ–∫—Å—Ç</summary>
                <pre class="mt-2 text-sm whitespace-pre-wrap">{{ p.body }}</pre>
              </details>
            </div>
            <form method="post" action="{{ url_for('admin_prompts_activate', pid=p.id) }}" class="shrink-0">
              <button class="px-3 py-1.5 rounded-lg bg-indigo-600 text-white hover:bg-indigo-700">–ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞—Ç—å</button>
            </form>
          </div>
        {% endfor %}
      </div>
    </div>
  </div>
</div>
{% endblock %}
