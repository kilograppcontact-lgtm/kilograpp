  {% extends 'base.html' %}
  {% block content %}

  <style>
/* --- Секции на всю высоту без «лишнего хвоста» на мобилке --- */
.section-full{
  min-height: 100vh;            /* базовый фолбэк */
  display: flex;
  align-items: center;
}
@supports (height: 100svh){
  .section-full{ min-height: 100svh; } /* корректная высота на мобилке */
}
@media (max-width: 899px){
  .section-full{
    align-items: flex-start;
    padding-top: 20px;
    padding-bottom: 24px;
  }
}
.section-full--top{ align-items: flex-start; }

/* --- Переупорядочиваем колонки на мобилке, чтобы картинки не шли подряд --- */
@media (max-width: 899px){
  /* Секция с картинкой справа на десктопе:
     на мобилке сначала картинка, потом текст */
  .section-grid--img-right > :first-child{ order: 2; } /* текст */
  .section-grid--img-right > :last-child { order: 1; } /* изображение */

  /* Секция с картинкой слева на десктопе:
     на мобилке сначала текст, потом картинка */
  .section-grid--img-left > :first-child{ order: 2; }  /* изображение */
  .section-grid--img-left > :last-child { order: 1; }  /* текст */

  /* Правка инлайнового стиля у часов, чтобы не уезжало */
  .section-grid--img-right .device-img{
    width: 100% !important;
    margin-left: 0 !important;
  }
}

/* На всякий: чтобы трансформации не создавали горизонтальный скролл */
.devices-page{ overflow-x: hidden; }


    /* ===== Страница устройств: белый фон, центрирование, плотные кнопки ===== */
    :root{ --border-soft:#e2e8f0; }

    /* Абсолютно белый фон страницы */
    .devices-page{ background:#fff; }

    /* Центрирующий контейнер */
    .devices-container{
      max-width: 1120px;
      margin: 0 auto;
      padding: 0 16px;
    }

    /* Сетки секций */
    .section-grid{
      display: grid;
      gap: clamp(1.25rem, 3vw, 2.25rem);
      align-items: center;
      justify-items: center;
      grid-template-columns: 1fr;
    }
    @media (min-width: 900px){
      .section-grid--img-left { grid-template-columns: 460px 1fr; }
      .section-grid--img-right{ grid-template-columns: 1fr 460px; }
    }

    .content-narrow{ max-width: 640px; }

    /* Кадр для PNG, белый фон */
    .device-figure{ width:min(100%, 360px); }
    .img-frame{
      position: relative; border-radius: 1rem; overflow: hidden;
      transform: perspective(1000px) rotateX(0) rotateY(0);
      transition: transform .35s ease, box-shadow .35s ease, filter .35s ease;
    }
    .img-pad{ padding: 18px; }
    .device-img{ width:100%; height:auto; object-fit:contain; filter: drop-shadow(0 8px 16px rgba(2,6,23,.12)); }

  /* Масштабируем всю карточку с изображением */
  .js-tilt{
    transition: transform .35s ease;
    transform-origin: center;
  }
  .js-tilt:hover{
    transform: scale(1.2);
  }

    /* «Shine» при первом появлении */
    .img-shine{ position: relative; }
    .img-shine::after{
      content:""; position:absolute; inset:-35% -15%; pointer-events:none;
      background: linear-gradient(115deg, transparent 40%, rgba(255,255,255,.45) 50%, transparent 60%);
      transform: translateX(-120%) rotate(10deg);
    }
    .img-shine.inview::after{ animation: shine-sweep 1s .2s ease-out both; }
    @keyframes shine-sweep { to { transform: translateX(120%) rotate(10deg);} }

    /* Плавающие стат-чипы */
    .stat-chip{
      position:absolute; padding:.45rem .7rem; border-radius:.75rem; font-weight:700; font-size:.78rem;
      background:#fff; border:1px solid var(--border-soft);
      box-shadow: 0 10px 24px rgba(2,6,23,.08);
      animation: float var(--float-dur, 6s) ease-in-out infinite;
    }
    @keyframes float{0%,100%{transform:translateY(0)}50%{transform:translateY(-6px)}}
    @media (max-width: 899px){ .stat-chip{ display:none; } }

    /* Чипы-характеристики и бейджи фич */
    .chips .chip{
      background: linear-gradient(180deg, #fff, #f8fafc);
      border:1px solid var(--border-soft); border-radius:999px;
      padding:.35rem .75rem; font-size:.8rem; font-weight:600; color:#0f172a;
    }
    .feature-badge{
      display:inline-flex; align-items:center; gap:.5rem;
      padding:.6rem .9rem; border-radius:.75rem; font-weight:700; font-size:.92rem;
      background:#f8fafc; border:1px solid var(--border-soft); color:#0f172a;
      transition: transform .2s ease, box-shadow .2s ease;
    }
    .feature-badge:hover{ transform: translateY(-1px); box-shadow: 0 8px 18px rgba(2,6,23,.08); }

    /* Плотные кнопки */
    .devices-page .btn{
      display:inline-flex; align-items:center; justify-content:center;
      border:1px solid transparent; border-radius:.65rem; font-weight:800;
      padding:.75rem 1.15rem; transition:transform .15s ease, box-shadow .2s ease, background-color .15s ease;
      transform: translateY(0);
    }
    .devices-page .btn:active{ transform: translateY(1px); }

    .devices-page .btn-primary{
      background:#2563eb; color:#fff; border-color:#2563eb;
      box-shadow: 0 6px 16px rgba(37,99,235,.28);
    }
    .devices-page .btn-primary:hover{ background:#1d4ed8; border-color:#1d4ed8; box-shadow: 0 10px 22px rgba(29,78,216,.32); }

    .devices-page .btn-secondary{
      background:#0f172a; color:#fff; border-color:#0f172a;
      box-shadow: 0 6px 16px rgba(2,6,23,.22);
    }
    .devices-page .btn-secondary:hover{ background:#111827; border-color:#111827; box-shadow: 0 10px 22px rgba(2,6,23,.28); }

    .btn-order{ position:relative; overflow:hidden; }
    .btn-order::after{
      content:""; position:absolute; inset:-40% -10%;
      transform: rotate(12deg) translateX(-120%);
      background: linear-gradient(90deg, transparent, rgba(255,255,255,.35), transparent);
      transition: transform .6s ease;
    }
    .btn-order:hover::after{ transform: rotate(12deg) translateX(120%); }

    /* ====== БОЛЕЕ ЖИВЫЕ СКРОЛЛ-Анимации ====== */
    .reveal{
      opacity:0; filter:saturate(.9);
      transform: translateY(24px) scale(.98);
      transition:
        transform .7s cubic-bezier(.16,.84,.44,1),
        opacity  .6s ease,
        filter   .6s ease;
      transition-delay: var(--reveal-delay, 0s);
      will-change: transform, opacity, filter;
    }
    .reveal.inview{
      opacity:1; filter:none; transform: none;
    }

    /* «Pop» для мелких элементов, когда родитель появился */
    .pop{ transform-origin: center; }
    .pop.inview{ animation: pop-in .5s var(--reveal-delay, 0s) cubic-bezier(.22,1,.36,1) both; }
    @keyframes pop-in {
      0%   { transform: translateY(12px) scale(.96); opacity:0; }
      60%  { transform: translateY(-3px) scale(1.02); opacity:1; }
      100% { transform: translateY(0) scale(1); }
    }

    /* Toast-пустышка */
    .toast{
      position: fixed; right: 1rem; bottom: 1rem; z-index: 60;
      background:#0f172a; color:#fff; padding:.875rem 1rem; border-radius:.75rem;
      box-shadow: 0 10px 30px rgba(2,6,23,.25); opacity:0; transform: translateY(8px);
      transition: opacity .25s ease, transform .25s ease;
    }
    .toast.show{ opacity:1; transform: translateY(0); }

    /* Respect reduced motion */
    @media (prefers-reduced-motion: reduce){
      .reveal, .pop, .img-frame, .stat-chip{ animation:none !important; transition:none !important; transform:none !important; }
    }

    /* === FAQ: компактный аккордеон, адаптивный === */
.faq{
  padding-top: clamp(24px, 5vw, 56px);
  padding-bottom: clamp(24px, 6vw, 72px);
}

.faq-title{ margin-bottom: clamp(12px, 3vw, 20px); }

.faq-grid{
  display:grid;
  grid-template-columns: 1fr;
  gap: 10px;
  max-width: 900px;
  margin: 0 auto;
}
@media (min-width: 980px){
  .faq-grid{ grid-template-columns: 1fr 1fr; }
}

/* Карточка вопроса */
.faq-item{
  border:1px solid var(--border-soft);
  border-radius: .9rem;
  background:#fff;
  box-shadow: 0 8px 20px rgba(2,6,23,.06);
  overflow: hidden;
  transition: box-shadow .2s ease, transform .2s ease;
}
.faq-item:hover{ transform: translateY(-1px); box-shadow: 0 12px 26px rgba(2,6,23,.09); }

/* Кнопка вопроса */
.faq-q{
  width:100%;
  appearance:none; border:0; background:linear-gradient(180deg,#fff,#f8fafc);
  display:flex; align-items:center; gap:.8rem; justify-content:space-between;
  padding:.95rem 1.1rem; cursor:pointer; font-weight:700; font-size:1rem; color:#0f172a;
}

/* Иконка (+) → поворот при открытии */
.faq-q .ico{ width:1.1rem; height:1.1rem; flex:0 0 auto; transition: transform .25s ease; }
.faq-item[aria-expanded="true"] .faq-q .ico{ transform: rotate(45deg); }

/* Контейнер ответа: CSS-аккордеон без дерганья */
.faq-a{
  display:grid; grid-template-rows:0fr;
  transition: grid-template-rows .3s ease, padding .3s ease;
}
.faq-item[aria-expanded="true"] .faq-a{ grid-template-rows:1fr; }
.faq-a > div{ overflow:hidden; padding:0 1.1rem 0; }
.faq-item[aria-expanded="true"] .faq-a > div{ padding-bottom:.9rem; }
.faq-a p{ margin:.25rem 0 0; color:#475569; line-height:1.5; }

/* Убираем «растяжку» на весь экран — FAQ не форсится в 100vh */
#faq.section-full, #faq.section-full--top{ min-height:auto; }

  </style>

  <div class="devices-page">
    <div class="devices-container">

      <!-- Секция 1: Стартовый бокс (на всю высоту экрана) -->
  <section class="reveal section-full p-0 bg-white w-full" data-reveal-delay="0ms">
        <div class="w-full max-w-7xl mx-auto px-4">
          <!-- Заголовок -->
          <header class="reveal text-center mb-10" data-reveal-delay="50ms">
            <h1 class="text-4xl md:text-5xl font-extrabold tracking-tight text-slate-900">
              Умные устройства
              <span class="inline-flex items-center gap-2 align-middle pop" data-reveal-delay="120ms">
                <img
                  src="{{ url_for('static', filename='logo.png') }}"
                  alt="Kilogr.app"
                  class="h-[3.75rem] md:h-[4.125rem] w-auto object-contain"
                  loading="lazy"
                />
              </span>
            </h1>
            <p class="mt-3 text-slate-600 max-w-2xl mx-auto reveal" data-reveal-delay="140ms">
              Прозрачная аналитика, автоматический учёт и идеальная синхронизация с вашим профилем.
            </p>
          </header>

          <!-- Контент -->
<div class="grid md:grid-cols-2 gap-10 items-center justify-items-center">
            <!-- Картинка -->
            <div class="relative device-figure js-tilt" data-tilt="6">
              <div class="img-frame img-shine img-pad reveal" data-reveal-delay="100ms">
                <img
                  src="{{ url_for('static', filename='devices/box.png') }}"
                  alt="Стартовый бокс Kilogr.app"
                  class="device-img"
                  loading="lazy"
                />
              </div>
              <div class="stat-chip" style="--float-dur:6.0s; top:8%; left:-5%;">⌚ Часы</div>
              <div class="stat-chip" style="--float-dur:6.6s; bottom:8%; right:-5%;">⚖️ Весы</div>
              <div class="stat-chip" style="--float-dur:7.2s; top:48%; right:-3%;">🔗 Кабель</div>
            </div>

            <!-- Текст -->
            <div class="content-narrow text-center md:text-left">
              <div class="chips flex flex-wrap justify-center md:justify-start gap-2 mb-4 stagger">
                <span class="chip">Быстрый старт</span>
                <span class="chip">Подарочные 30 дней PRO</span>
                <span class="chip">Поддержка 24/7</span>
              </div>
              <h2 class="text-3xl font-bold text-slate-900 reveal" data-reveal-delay="70ms">Стартовый бокс</h2>
              <p class="mt-3 text-slate-600 reveal" data-reveal-delay="120ms">
                Всё, чтобы начать прогресс сегодня: умные часы, биоимпедансные весы и доступ к расширенной аналитике.
                Включили — подключили — результаты собираются сами.
              </p>

              <ul class="mt-5 space-y-2 stagger">
                <li class="feature-badge">✅ Автосинхронизация с профилем</li>
                <li class="feature-badge">✅ Точные метрики тела и активности</li>
                <li class="feature-badge">✅ Готовые сценарии и напоминания</li>
              </ul>

              <div class="mt-6 flex flex-wrap gap-3 justify-center md:justify-start">
                <button onclick="orderPlaceholder()" class="btn btn-primary btn-order pop" data-reveal-delay="160ms">🛒 Заказать бокс</button>
                <a href="#faq" class="btn btn-secondary pop" data-reveal-delay="190ms">Вопросы и ответы</a>
              </div>
            </div>
          </div>
        </div>
      </section>

      <!-- Секция 2: Умные часы -->
  <section class="reveal section-full" data-reveal-delay="0ms">
        <div class="section-grid section-grid--img-right">
          <!-- Текст -->
          <div class="content-narrow text-center md:text-left">
            <div class="chips flex flex-wrap gap-2 mb-3 justify-center md:justify-start stagger">
              <span class="chip">Пульс и зоны ЧСС</span>
              <span class="chip">Сон и стресс</span>
              <span class="chip">GPS-маршруты</span>
            </div>
            <h2 class="text-3xl font-bold text-slate-900 reveal" data-reveal-delay="60ms">Умные часы</h2>
            <p class="mt-3 text-slate-600 reveal" data-reveal-delay="110ms">
              Отслеживайте тренировки, пульс, стадии сна и расход калорий.
              Вся активность автоматически учитывается в расчётах дефицита/профицита.
            </p>
            <ul class="mt-4 space-y-2 stagger">
              <li class="feature-badge">⏱️ Тренировки: бег, силовые, HIIT</li>
              <li class="feature-badge">💤 Аналитика сна и рекомендации</li>
              <li class="feature-badge">🔔 Умные напоминания и цели</li>
            </ul>
            <div class="mt-6">
              <button onclick="orderPlaceholder()" class="btn btn-primary btn-order pop" data-reveal-delay="160ms">🛒 Заказать часы</button>
            </div>
          </div>

          <!-- Картинка -->
          <div class="relative device-figure js-tilt" data-tilt="6">
            <div class="img-frame img-shine img-pad reveal" data-reveal-delay="100ms">
              <img src="{{ url_for('static', filename='devices/watch.png') }}"
                   alt="Умные часы Kilogr.app" class="device-img watch" loading="lazy" style="width:75%; margin-left:44px">
            </div>
            <div class="stat-chip" style="--float-dur:6.2s; top:8%; right:-5%;">❤️ 68 уд/мин</div>
            <div class="stat-chip" style="--float-dur:6.8s; bottom:10%; left:-5%;">🔥 520 ккал</div>
            <div class="stat-chip" style="--float-dur:7.4s; top:50%; left:-4%;">💤 7ч 40м</div>
          </div>
        </div>
      </section>
      <!-- Секция 3: Умные весы -->
  <section class="reveal section-full" data-reveal-delay="0ms">
        <div class="section-grid section-grid--img-left">
          <!-- Картинка -->
          <div class="relative device-figure js-tilt" data-tilt="6">
            <div class="img-frame img-shine img-pad reveal" data-reveal-delay="100ms">
              <img src="{{ url_for('static', filename='devices/scales.png') }}"
                   alt="Умные весы Kilogr.app" class="device-img" loading="lazy">
            </div>
            <div class="stat-chip" style="--float-dur:6.0s; top:10%; left:-5%;">⚖️ 72.4 кг</div>
            <div class="stat-chip" style="--float-dur:6.7s; bottom:12%; right:-5%;">🧈 18.9%</div>
            <div class="stat-chip" style="--float-dur:7.3s; top:48%; right:-3%;">💧 56.2%</div>
          </div>

          <!-- Текст -->
          <div class="content-narrow text-center md:text-left">
            <div class="chips flex flex-wrap gap-2 mb-3 justify-center md:justify-start stagger">
              <span class="chip">Биоимпеданс</span>
              <span class="chip">Мышцы/жир/вода</span>
              <span class="chip">Тренды</span>
            </div>
            <h2 class="text-3xl font-bold text-slate-900 reveal" data-reveal-delay="60ms">Умные весы</h2>
            <p class="mt-3 text-slate-600 reveal" data-reveal-delay="110ms">
              Получайте метрики состава тела и отслеживайте прогресс — всё отображается в «Показателях»
              и влияет на рекомендации по питанию.
            </p>
            <ul class="mt-4 space-y-2 stagger">
              <li class="feature-badge">📈 Прогресс жиросжигания в процентах</li>
              <li class="feature-badge">💪 Оценка мышечной массы</li>
              <li class="feature-badge">🔄 Автозагрузка результатов в профиль</li>
            </ul>
            <div class="mt-6">
              <button onclick="orderPlaceholder()" class="btn btn-primary btn-order pop" data-reveal-delay="160ms">🛒 Заказать весы</button>
            </div>
          </div>
        </div>
      </section>
<!-- FAQ (переписано) -->
<section id="faq" class="reveal faq" data-reveal-delay="0ms">
  <header class="faq-title">
    <h2 class="text-3xl font-bold text-slate-900 text-center">Вопросы и ответы</h2>
  </header>

  <div class="faq-grid" data-faq data-mode="single">
    <!-- item 1 -->
    <article class="faq-item" aria-expanded="false">
      <button class="faq-q" type="button" aria-controls="faq-a-1" aria-expanded="false">
        <span class="q">Что входит в стартовый бокс?</span>
        <svg class="ico" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
      <div id="faq-a-1" class="faq-a" role="region" aria-labelledby="faq-q-1">
        <div>
          <p>Часы, весы, кабель/батарейки (по модели), краткое руководство и 30 дней доступа к PRO-функциям.</p>
        </div>
      </div>
    </article>

    <!-- item 2 -->
    <article class="faq-item" aria-expanded="false">
      <button class="faq-q" type="button" aria-controls="faq-a-2" aria-expanded="false">
        <span class="q">Как подключить устройства?</span>
        <svg class="ico" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
      <div id="faq-a-2" class="faq-a" role="region" aria-labelledby="faq-q-2">
        <div>
          <p>Откройте профиль → «Подключить устройства». Следуйте мастеру — синхронизация занимает пару минут.</p>
        </div>
      </div>
    </article>

    <!-- item 3 -->
    <article class="faq-item" aria-expanded="false">
      <button class="faq-q" type="button" aria-controls="faq-a-3" aria-expanded="false">
        <span class="q">Можно ли купить часы и весы отдельно?</span>
        <svg class="ico" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
      <div id="faq-a-3" class="faq-a" role="region" aria-labelledby="faq-q-3">
        <div>
          <p>Да, в соответствующих секциях есть кнопка «Заказать». Сейчас это демо-кнопки — скоро запустим предзаказ.</p>
        </div>
      </div>
    </article>

    <!-- item 4 -->
    <article class="faq-item" aria-expanded="false">
      <button class="faq-q" type="button" aria-controls="faq-a-4" aria-expanded="false">
        <span class="q">Будут ли данные учитываться в диете и метриках?</span>
        <svg class="ico" viewBox="0 0 24 24" aria-hidden="true">
          <path d="M12 5v14M5 12h14" stroke="currentColor" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </button>
      <div id="faq-a-4" class="faq-a" role="region" aria-labelledby="faq-q-4">
        <div>
          <p>Да. Тренировки, активкалории, вес и состав тела автоматически подтягиваются в «Показатели» и учитываются в рекомендациях.</p>
        </div>
      </div>
    </article>
  </div>
</section>

      <!-- Toast-пустышка -->
      <div id="orderToast" class="toast">🚧 Скоро откроем предзаказ. Оставьте контакт в профиле, и мы напишем!</div>

    </div>
  </div>

  <script>
    /* === IntersectionObserver: появление + подхват задержек === */
    (function(){
      const items = document.querySelectorAll('.reveal, .pop, .img-shine');
      if(!('IntersectionObserver' in window) || !items.length){
        items.forEach(el => el.classList.add('inview'));
        return;
      }
      const io = new IntersectionObserver((entries)=>{
        entries.forEach(e=>{
          if(e.isIntersecting){
            const el = e.target;
            const delay = el.getAttribute('data-reveal-delay');
            if (delay) el.style.setProperty('--reveal-delay', delay);
            el.classList.add('inview');
            io.unobserve(el);
          }
        });
      }, { rootMargin:'0px 0px -10% 0px', threshold:.1 });
      items.forEach(el => io.observe(el));
    })();

    /* === Авто-стэггер для .stagger: навешиваем .reveal детям с нарастающей задержкой === */
    (function(){
      document.querySelectorAll('.stagger').forEach(group=>{
        const children = Array.from(group.children);
        children.forEach((el, i)=>{
          el.classList.add('reveal');
          el.style.setProperty('--reveal-delay', `${80 + i*70}ms`);
        });
      });
    })();

    /* === Tilt эффект для .js-tilt (микронаклон по курсору) === */
    (function(){
      const els = document.querySelectorAll('.js-tilt');
      els.forEach(wrapper=>{
        const inner = wrapper.querySelector('.img-frame') || wrapper;
        const strength = parseFloat(wrapper.dataset.tilt || '6');
        let raf = null;

        function onMove(e){
          const r = wrapper.getBoundingClientRect();
          const px = (e.clientX - r.left)/r.width - .5;
          const py = (e.clientY - r.top)/r.height - .5;
          cancelAnimationFrame(raf);
          raf = requestAnimationFrame(()=>{
            inner.style.transform =
              `perspective(1000px) rotateX(${(-py*strength)}deg) rotateY(${(px*strength)}deg) translateY(-2px)`;
          });
        }
        function onLeave(){
          cancelAnimationFrame(raf);
          inner.style.transform = 'perspective(1000px) rotateX(0) rotateY(0)';
        }

        wrapper.addEventListener('mousemove', onMove);
        wrapper.addEventListener('mouseleave', onLeave);
        // На тач — без эффекта
      });
    })();

    /* === Пустышка «Заказать» — тост === */
    let _toastTimer=null;
    function orderPlaceholder(){
      const t=document.getElementById('orderToast');
      if(!t) return;
      t.classList.add('show');
      clearTimeout(_toastTimer);
      _toastTimer=setTimeout(()=>t.classList.remove('show'), 2600);
    }
  </script>
<script>
  /* === FAQ accordion === */
  (function(){
    const root = document.querySelector('[data-faq]');
    if(!root) return;
    const single = root.dataset.mode === 'single';
    const items  = root.querySelectorAll('.faq-item');

    items.forEach((item, idx) => {
      const btn = item.querySelector('.faq-q');
      const panel = item.querySelector('.faq-a');
      if(!btn || !panel) return;

      // a11y ids
      const qId = `faq-q-${idx+1}`, aId = `faq-a-${idx+1}`;
      btn.id = qId; panel.id = aId;
      btn.setAttribute('aria-controls', aId);

      btn.addEventListener('click', () => {
        const open = item.getAttribute('aria-expanded') === 'true';
        if(single){
          items.forEach(i => i !== item && i.setAttribute('aria-expanded','false'));
        }
        item.setAttribute('aria-expanded', open ? 'false' : 'true');
        btn.setAttribute('aria-expanded', open ? 'false' : 'true');
      });
    });
  })();
</script>

  {% endblock %}
